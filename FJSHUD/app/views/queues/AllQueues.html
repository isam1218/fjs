<div class="ToolBar Queues">
	<input class="SearchBox" type="search" ng-model-options="{debounce: 200}" ng-model="que.query" x-webkit-speech="" ng-attr-placeholder="{{::verbage.search}}" />
		
  <div class="XButton QueueButtonToggle XButtonNormal" ng-click="viewIcon = !viewIcon">
    <div class="QueueViewIcon" ng-class="viewIcon ? 'QueueListView' : 'QueueTileView'"></div>
  </div>
  <div class="SelectBox selectWrapper queue" ng-if="viewIcon">
    <select ng-if="viewIcon"
      ng-model="selectedQueue"
            ng-options="queue_option.display_name for queue_option in queue_options | filter: truncateLongAction() track by queue_option.display_name" 
      ng-change="setQueueSort(selectedQueue)">
    </select>
  </div>
</div>

<div class="ListViewTopSpace"></div>

<div ng-if="viewIcon" class="QueueList">
	<div class="Block" ng-repeat="queue in queues | filter: que.query | orderBy: [sortColumn, '-name']: isAscending track by queue.xpid" dockable="queue">
		<a href="#/queue/{{::queue.xpid}}" class="Header">
			<avatar profile="queue"></avatar>
			<div class="Title">
				<div class="Name">{{ ::queue.name }}</div>
				<div class="Agents">{{::verbage.agents}}: {{ queue.info.active + ' / ' + queue.loggedInMembers + ' / ' + queue.members.length }}</div>
			</div>
		</a>
		
		<div class="Stats">
			<div ng-class="{'RedText': queueThresholds.waiting && queue.info.waiting > queueThresholds.waiting}">
				<strong>{{ queue.info.waiting }}</strong>
				{{::verbage.waiting}}
			</div>
			<div>
				<strong ng-if="queue.longestWait > 0" timer="queue.longestWait"></strong>
				<strong ng-if="queue.longestWait == 0">00:00</strong>
				{{::verbage.avg_wait}}
			</div>
			<div ng-class="{'RedText': queueThresholds.avg_talk && queue.info.avgTalk/60 > queueThresholds.avg_talk}">
				<strong>{{ queue.info.avgTalk*1000 | duration }}</strong>
				{{::verbage.avg_talk}}
			</div>
			<div >
				<strong>{{ queue.info.abandon + queue.info.completed }}</strong>
				{{::verbage.talk}}
			</div>
			<div ng-class="{'RedText': queueThresholds.abandoned && queue.info.abandonPercent > queueThresholds.abandoned}">
				<strong>{{ queue.info.abandonPercent }}%</strong>
				{{::verbage.aban}}
			</div>
			<div>
				<strong>{{ queue.info.active }}</strong>
				{{::verbage.active}}
			</div>
		</div>
	</div>
</div>

<div ng-if="!viewIcon" class="QueueList">
	<div class="Grid">
		<div class="Header">
			<div ng-click="setSort('name', selectedQueue)">
				<span>{{::verbage.queue_name}}</span>
				<div ng-if="sortColumn == 'name'" ng-class="isAscending ? 'desc_arrow' : 'asc_arrow'"></div>
			</div>			
			<div ng-click="setSort('longestWait', selectedQueue)">
                <span>{{::verbage.longest_hold}}</span>     
                <div ng-if="sortColumn == 'longestWait'" ng-class="isAscending ? 'asc_arrow' : 'desc_arrow'"></div>
            </div>
            <div ng-click="setSort('info.waiting', selectedQueue)">
                <span>{{::verbage.waiting}}</span>      
                <div ng-if="sortColumn == 'info.waiting'" ng-class="isAscending ? 'asc_arrow' : 'desc_arrow'"></div>
            </div>
			<div ng-click="setSort('info.esa', selectedQueue)">
				<span>{{::verbage.avg_wait}}</span>		
				<div ng-if="sortColumn == 'info.esa'" ng-class="isAscending ? 'asc_arrow' : 'desc_arrow'"></div>
			</div>
			<div ng-click="setSort('info.avgTalk', selectedQueue)">
				<span>{{::verbage.avg_talk}}</span>		
				<div ng-if="sortColumn == 'info.avgTalk'" ng-class="isAscending ? 'asc_arrow' : 'desc_arrow'"></div>
			</div>			
			<div ng-click="setSort('info.abandonPercent', selectedQueue)">
				<span>{{::verbage.abandoned}}</span>		
				<div ng-if="sortColumn == 'info.abandonPercent'" ng-class="isAscending ? 'asc_arrow' : 'desc_arrow'"></div>
			</div>
			<div ng-click="setSort('info.active', selectedQueue)">
				<span>{{::verbage.active}}</span>		
				<div ng-if="sortColumn == 'info.active'" ng-class="isAscending ? 'asc_arrow' : 'desc_arrow'"></div>
			</div>
		</div>
		<div class="Table">
			<a href="#queue/{{::queue.xpid}}" class="Row" ng-repeat="queue in queues | filter: que.query | orderBy: [sortColumn, '-name']: isAscending track by queue.xpid" dockable="queue">
                <div>{{ ::queue.name }}</div>				
				<div>
                    <span ng-if="queue.longestWait > 0" timer="queue.longestWait"></span>
                    <span ng-if="queue.longestWait == 0">00:00</span>
                </div>
                <div ng-class="{'RedText': queueThresholds.waiting && gadget.data.info.waiting > queueThresholds.waiting}">{{ queue.info.waiting}}</div>
				<div ng-class="{'RedText': queueThresholds.avg_wait && queue.info.esa/60 > queueThresholds.avg_wait}">{{ queue.info.esa*1000 | duration}}</div>
				<div ng-class="{'RedText': queueThresholds.avg_talk && queue.info.avgTalk/60 > queueThresholds.avg_talk}">{{ queue.info.avgTalk*1000 | duration}}</div>				
				<div ng-class="{'RedText': queueThresholds.abandoned && queue.info.abandonPercent > queueThresholds.abandoned}">{{ queue.info.abandonPercent }}%</div>
				<div>{{ queue.info.active }}</div>
			</a>
		</div>
	</div>
</div>

<div class="ToolBarBottom" ng-show="selected == 'allqueues'">
  <input type="button" class="XButton" value="Reset All Stats" ng-click="resetStats()"  />
</div>


