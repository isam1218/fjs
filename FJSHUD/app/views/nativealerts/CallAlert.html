<link rel="stylesheet" ng-href="{{path}}/styles/main.css" />
<link rel="stylesheet" ng-href="{{path}}/styles/nativeAlert.css" />

<div id="CallAlert">  
  <div onclick="window.location.replace('#/Close')" class="close"></div>  
  <a ng-href="#contact/{{::meModel.my_pid}}"  class="ListRowFirst ListRow ListRow-Contact">     
   <div class="Avatar"><img ng-src="{{ getAvatar(meModel.my_pid) }}" class="AvatarImgPH"></div>
  <!-- <avatar profile="meContact"></avatar> -->

  <div class="ListRowContent">
    <div class="NotificationTitle">
      <div class="name">
        <span>{{ ::meModel.display_name }}</span>
      </div>
    </div>
    <div class="body">
      <div class="ListRowStatusIcon XIcon-QueueStatus XIcon-QueueStatus-{{meModel.queue_agent_status}}">
        <div class="status-icon-inner"></div>
      </div>
      <div class="ListRowStatusIcon XIcon-ChatStatus-{{meModel.chat_status || 'offline' }}">
        <div class="status-icon-inner"></div>
      </div>
      <div class="ListRowStatusText">{{meModel.chat_status || 'offline'}}</div>
    </div>
   </div>
  </a>
  

  <div class="CallStatusContainerOutbound" ng-repeat="currentCall in calls" ng-class="currentCall.type != 5 ? 'CallStatusContainerInbound' : 'CallStatusContainerOutbound'" >                            
     <a href="#/showCallControlls?{{currentCall.xpid}}" class="CallStatusIconContainer">
         <div class="CallStatusIcon"> </div>
     </a>
   
     <a href="#/showCallControlls?{{currentCall.xpid}}" class="CallStatusText"> 
         <div class="memberName">{{currentCall.displayName}}<div class="MyCallBlock_Rec ng-class:{'true': currentCall.record}"></div></div>
         <div class="callStatus">{{ currentCall.incoming ? verbage.inbound : verbage.outbound}} {{::verbage.on_call + ' '}} <span class="MyCallBlock_Duration" data-duration="{{callObj[currentCall.xpid].nativeTime}}"></span></div>
     </a>                 
    <!--{{callObj[currentCall.xpid].minutesText}}{{callObj[currentCall.xpid].secondsText}}{{callObj[currentCall.xpid].hoursText}}-->
	<div class="controlButtons">
         <a href="#/EndCall?{{currentCall.xpid}}" ng-if="currentCall.state == callState.CALL_RINGING" class="XButton">{{:: currentCall.incoming ? verbage.decline : verbage.cancel}}</a>
         <a href="#/EndCall?{{currentCall.xpid}}" class="XButton" ng-if="currentCall.state == callState.CALL_ACCEPTED">{{::verbage.end}}</a>
         <a href="#/HoldCall?{{currentCall.xpid}}&false" ng-class="currentCall.type == 0 ? 'disableButton' : ''" ng-disabled="currentCall.type == 0" ng-if="currentCall.state == callState.CALL_ACCEPTED" class="XButton">{{::verbage.hold}}</a>
         <a href="#/ResumeCall?{{currentCall.xpid}}&true" class="XButton" ng-if="currentCall.state == callState.CALL_HOLD">{{::verbage.Talk}}</a>
         <a href="#/AcceptCall?{{currentCall.xpid}}" ng-if="currentCall.incoming && currentCall.state == callState.CALL_RINGING" class="XButton">{{::verbage.accept}}</a>
         
    </div>
  </div>
  
  <div class="Notifications">
	<div class="LeftBarNotificationSection notificationsSection hasMessages" ng-class="{'Expand': todaysNotifications.length > 0}">
	<div class="NotificationMessages LeftBarNotifications">
		<div class="TitleBar">
			<div class="HasNotificationIcon"></div>
			<div>{{::verbage.notifications}}</div>
			<div class="Event"> - {{getNotificationsLength(notifications.length)+ ' ' + verbage.events}} </div>
			<input type="button" value="{{::verbage.open}}" class="XButton" onclick="window.location.replace('#/OpenNotifications')" />
		</div>   
		
		<div class="scroller">  	
	        <div class="Messages" ng-repeat="message in todaysNotifications track by message.xpid" ng-show="showHideElements($index)">			
				<div class="NotificationHeader">
					<div class="NotificationHeaderBackground">
						<a href="#/RemoveNotification?{{message.xpid}}">
							<div class="NotificationClose"></div>
						</a>
					</div>
				</div>
				<div class="NotificationDivider"></div>
				<div class="NotificationSection open" >
					<avatar 
						class="LeftBarNotificationAvatarSection NotificationAvatar"
						ng-click="go_to_notification_chat(message)" 
						profile="message.fullProfile" 
						type="{{::message.type == 'chat' ? 11 : message.audience == 'queue' ? 3 : 4}}">
					</avatar>
				
					<div class="LeftBarNotificationMessageSection">
						<a href="#/goToChat?{{message.context}}&{{message.xpid}}" class="chatNotification">
							<div class="" ng-class="::message.audience == 'queue' ? 'NotificationDisplayNameQueue' : 'NotificationDisplayName'" >
								<span ng-if="::message.displayName">{{ ::message.displayName}}</span>
								<span ng-if="::!message.displayName" style="width: 38.5%;">&nbsp;</span> 
								<div class="NotificationTime">{{ ::message.time | fondate:'MMMM D YYYY, hh:mm a':fon_lang_code    }} </div>
							</div> 
							<div class="NotificationType" ng-show="showNotificationBody">
								...{{ ::message.label }} 
								<span class='NotificationDisplayName' ng-if="::message.type == 'gchat'">
									{{ ::message.conference ? 'Room #' + message.conference.roomNumber + ' (' + message.conference.extensionNumber + ')' : message.title }}
								</span>
							</div>
							<div class="NotificationMessage" scroll-to-bottom ng-bind-html="formatMessage(message.message)"></div> 
						</a>
						
						<div class="NotificationZoomBtn" ng-if="::message.type == 'zoom'">
							<a class="XButton XButtonRed" href="#/RemoveNotification?{{message.xpid}}"> {{::verbage.Reject}}</a>
							<a class="XButton XButtonGreen" href="#/AcceptCall?{{message.senderId}}">{{::verbage.accept}}</a>
						</div>
						
						<div class="NotificationZoomBtn" ng-if="::message.type == 'vm'"> 
							<a class="XButton" href="#/PlayVM?{{message.vmId}}"> {{::verbage.Play}}</a>
							<a class="XButton XButtonGreen" href="#/CallBack?{{message.phone}}">{{::verbage.call_back}}</a>
						</div>

						<div class="NotificationZoomBtn" ng-if="::message.type == 'missed-call'">
							<a class="XButton chatNotification" href="#/goToChat?{{message.context}}&{{message.xpid}}">{{::verbage.chat}}</a>
							<a class="XButton XButtonGreen" href="#/callAndRemove?{{message.xpid}}&{{message.phone}}">{{::verbage.Call}}</a>	
						</div>
						
						<div class="NotificationZoomBtn" ng-if="::message.type == 'busy-ring-back'">
							<a class="XButton" href="#/RemoveNotification?{{message.xpid}}">{{::verbage.Skip}}</a>
							<a class="XButton XButtonGreen" href="#/CallBack?{{message.fullProfile.primaryExtension}}">{{::verbage.Call}}</a>	
						</div>
						
						<div class="NotificationZoomBtn" ng-if="::message.audience=='queue' && (message.type == 'q-alert-abandoned' || message.type == 'q-alert-rotation')">
							<a class="XButton" href="#/showQueue?{{message.queueId}}&{{message.audience}}&{{message.type}}&{{message.xpid}}">{{::verbage.Show}}</a>
						</div>
					</div>
				</div>

			</div>
 
			<div class="Messages plugins" ng-click="showOverlay(true,'DownloadPlugin',{});" ng-if="!phoneSessionEnabled">		
			  <a href="{{::pluginDownloadUrl}}" download target="_blank">
				<div class="NotificationHeader"> 
					<div class="NotificationHeaderBackground"> 
						<div class="NotificationClose" ng-click="remove_notification(message.xpid)"></div>
					</div>
				</div>
				<div class="NotificationDivider"></div>

				<div class="NotificationSection ng-class:{'last' : !anotherDevice}" >
					<div class="LeftBarNotificationAvatarSection " style="display:inline-block"> 
						<div class="AvatarWarningSmall"></div>
					</div>
				
					<div class="LeftBarNotificationMessageSection" > 
						<div class="chatNotification plugins">
							<div class="content"><span>Browser Plugin</span></span> <div class="NotificationTime">{{   }} </div></div> 
							<div ></div>

							<div class="NotificationMessage">Click to download & Install</div>
						</div>
						
					</div>
				</div>
			  </a>
			</div>
			
			<div class="Messages webphone" ng-if="anotherDevice" ng-click="$parent.activatePhone()">                
			    <div class="NotificationHeader">
                    <div class="NotificationHeaderBackground"> 
                        <div class="NotificationClose" ng-click="remove_notification(message.xpid)"></div>
                    </div>
                </div>
                <div class="NotificationDivider" ></div>
                <div class="NotificationSection webphone last"> 
                    
                    <div class="LeftBarNotificationAvatarSection " style="display:inline-block"> 
                        <div class="AvatarWarningSmall"></div>
                    </div>
                
                    <div class="LeftBarNotificationMessageSection" > 
                        <div class="chatNotification webphone">
                            <div class="content"><span>Web Phone</span></span> <div class="NotificationTime">{{   }} </div></div> 
                            <div ></div>

                            <div class="NotificationMessage">Phone registered on another device. Click on this message to set this instance as active.</div>
                        </div>
                        
                    </div>
                 </div>               
            </div> 
        </div>    
	</div>
	</div>
  </div>
</div>