<link rel="stylesheet" href="{{path}}/styles/main.css">  
<div id="CallAlert">    	
  <a href="#contact/{{::contact.xpid}}"  class="ListRowFirst ListRow ListRow-Contact">
    
	<div class="Avatar AvatarNormal"><img src="getAvatar(contact.xpid)" onerror="this.src='img/Generic-Avatar-28.png'" class="AvatarImgPH">
	   <div class="AvatarForeground AvatarInteractable"></div>
	</div>
	
	<div class="ListRowContent">
		<div class="NotificationTitle">
			<div class="name">
				<span>{{ ::meModel.display_name }}</span>
			</div>
		</div>
		
		<div class="CallStatus">
			<avatar 
				ng-if="contact.call.startedAt" 
				ng-click="showCallStatus($event, contact)" 
				profile="contact" 
				type="{{contact.call.type}}"></avatar>
		</div>
		
		<div class="body">
			<div class="ListRowStatusIcon XIcon-QueueStatus XIcon-QueueStatus-{{meModel.queue_agent_status}}">
				<div class="status-icon-inner"></div>
			</div>
			
			<div class="ListRowStatusIcon XIcon-ChatStatus-{{meModel.chat_status || 'offline' }}">
				<div class="status-icon-inner"></div>
			</div>
			<div class="ListRowStatusText">{{meModel.chat_status || 'offline'}}</div>
		</div>
	 </div>
	 <div onclick="window.location.replace('#/Close')" class="close"></div>
	</a>
  
    <div class="Notifications">
      <div class="LeftBarNotificationSection notificationsSection ng-class:{'noMessages' : todaysNotifications.length == 0}">
       <div class="NotificationMessages LeftBarNotifications">
        <div class="TitleBar" ng-show="!hasMessages">
	        <div ng-class="notifications.length > 0 ? 'HasNotificationIcon': 'NoNotificationIcon'" class="HasNotificationIcon"></div>
	        <div>{{::verbage.notifications}}</div>
	        <div class="Event" ng-show="notifications.length > 0"> - {{getNotificationsLength(notifications.length)+ ' ' + verbage.events}} </div>	       
	        <a href="#/OpenNotifications" value="{{::verbage.Open}}" class="XButton">{{::verbage.Open}}</a>
       </div> 
       <div class="scroller ng-class:{'single': todaysNotifications.length == 1}">
       
         <div class="Messages" ng-repeat="message in todaysNotifications"> 
           
            <div class="NotificationHeader ng-class:{'firstHeader': $index == 0}; firstHeader"> 
	         <div class="NotificationHeaderBackground ng-class:{'firstHeaderTitle': $index == 0}; firstHeaderTitle">	           
	           <a href="#/RemoveNotification?{{message.xpid}}" value="{{::verbage.Remove}}" class="NotificationClose"></a>
	        </div> 	             
	       </div>
	       
	       <div class="NotificationDivider ng-class:{'firstHeaderDivider': $index == 0} firstHeaderDivider"></div>
		   
		   <div class="NotificationSection ng-class:{'firstsection': $index == 0">
		   
		      <a class="LeftBarNotificationAvatarSection NotificationAvatar Avatar CallAvatar CallAvatar_Office" href="#/goToChat?{{message.xpid}}&{{message.audience}}" type="{{message.type == 'chat' ? 11 : message.audience == 'queue' ? 3 : 4}}">
		          <img class="AvatarImgPH" src="getAvatar(message.xpid)" onerror="this.src='img/Generic-Avatar-28.png'">
		          <div class="AvatarForeground AvatarInteractable"></div>
		      </a>		      		      
		      <div class="LeftBarNotificationMessageSection" ng-init="message_section_notifications = getMessage(message)"> 
		      
		        <a  href="#/goToChat?{{message.xpid}}&{{message.audience}}" class="chatNotification">
		         <div class="NotificationDisplayName" ng-class="message.audience == 'queue' ? 'NotificationDisplayNameQueue' : 'NotificationDisplayName'">
		          <span ng-if="message.displayName">{{ message.displayName}}</span>
		          <div class="NotificationTime"> </div>
		         </div> 
		       </a>	      
		       		      
		      <div class="NotificationType">...{{ ::message.label }}
		       <span class='NotificationDisplayName' ng-if="message.type == 'gchat'"> 
                                {{ message.audience == 'group' ? message.title : 'Room #' + message.conference.roomNumber + '(' + message.conference.extensionNumber + ')'}}
               </span>
		      </div>
		      
		      <div class="NotificationMessage" scroll-to-bottom> 
                 <span ng-if="message.message && message.message.length > 1" ng-repeat="messageToDisplay in message_section_notifications track by $index">{{ messageToDisplay }}<br/></span>
                 <span ng-if="!message.message || message.message <= 1">{{ message_section_notifications }}</span>                               
              </div>
              
              
              <div class="NotificationZoomBtn" ng-if="message.type == 'zoom'">
                   <a class="XButton XButtonRed" href="#/RemoveNotification?{{message.xpid}}"> {{::verbage.Reject}}</a>
                   <a class="XButton XButtonGreen" href="#/AcceptCall?{{message.senderId}}">{{::verbage.accept}}</a>               
               </div>
               <div class="NotificationZoomBtn" ng-if="message.type == 'vm'"> 
                   <a class="XButton" href="#/PlayVM?{{message.vmId}}"> {{::verbage.Play}}</a>
                   <a class="XButton XButtonGreen" href="#/CallBack?{{message.phone}}">{{::verbage.call_back}}</a>
               </div>

               <div class="NotificationZoomBtn" ng-if="message.type == 'missed-call'">
                   <a class="XButton chatNotification" href="#/goToChat?{{message.xpid}}&{{message.audience}}">{{::verbage.chat}}</a>
                   <a class="XButton XButtonGreen" href="#/callAndRemove?{{message.xpid}}&{{message.phone}}">{{::verbage.Call}}</a>  
               </div>
               
               <div class="NotificationZoomBtn" ng-if="message.type == 'busy-ring-back'">
                   <span class="XButton" ng-click="#/RemoveNotification?{{message.xpid}}">{{::verbage.Skip}}</span>
                   <span class="XButton XButtonGreen" ng-click="#/CallBack?{{message.fullProfile.primaryExtension}}">{{::verbage.Call}}</span>  
               </div>
               
               <a href="#/queue/{{message.queueId}}" class="NotificationZoomBtn" ng-if="message.audience=='queue' && (message.type == 'q-alert-abandoned' || message.type == 'q-alert-rotation')">
                   <span class="XButton" ng-click="showQueue(message)">{{::verbage.Show}}</span>
               </a>
                            
                            
			</div>		   
         </div>
       </div>
       
       <!-- <div class="Messages plugins" ng-click="showOverlay(true,'DownloadPlugin',{});" ng-if="!phoneSessionEnabled"> -->       
          <a class="Messages plugins"  href="#/getPlugins?{{pluginDownloadUrl}}"  ng-if="!phoneSessionEnabled" download target="_blank">
              <div class="NotificationHeader ng-class:{'firstHeader': todaysNotifications.length == 0};"> 
                 <div class="NotificationHeaderBackground ng-class:{'firstHeaderTitle': todaysNotifications.length == 0};"> 
                     <a class="NotificationClose" href="#/RemoveNotification?{{message.xpid}}"></a>
                 </div>                      
              </div>
              
              <div class="NotificationDivider ng-class:{'firstHeaderDivider': todaysNotifications.length == 0, 'noMessagess': todaysNotifications.length == 0}">                         
              </div>
              
              <div class="NotificationSection ng-class:{'firstsection': todaysNotifications.length == 0, 'last' : !anotherDevice}" > 
                  
                  <div class="LeftBarNotificationAvatarSection"> 
                      <div class="AvatarWarningSmall"></div>
                  </div>
              
                  <div class="LeftBarNotificationMessageSection" > 
                      <div class="chatNotification plugins">
                          <div class="content">
                            <span>Browser Plugin</span></span> 
                            <div class="NotificationTime">{{   }} </div>
                          </div> 
                          <div ></div>
                          <div class="NotificationMessage">Click to download & Install</div>
                      </div>
                      
                  </div>
              </div>
          </a>
       <!-- </div> -->
       
       <a class="Messages webphone" ng-if="anotherDevice" href="#/activatePhone">                
          <div class="NotificationHeader ng-class:{'firstHeader': phoneSessionEnabled && todaysNotifications.length == 0}">
                  <div class="NotificationHeaderBackground ng-class:{'firstHeaderTitle': phoneSessionEnabled && todaysNotifications.length == 0}"> 
                      <a class="NotificationClose" href="#/RemoveNotification?{{message.xpid}}"></a>
                  </div>
                  
          </div>
          <div class="NotificationDivider ng-class:{'firstHeaderDivider': phoneSessionEnabled && todaysNotifications.length == 0, 'noMessagess': todaysNotifications.length == 0}" >            
          </div>
          <div class="NotificationSection webphone last ng-class:{'firstsection': phoneSessionEnabled && todaysNotifications.length == 0}"> 
              
              <div class="LeftBarNotificationAvatarSection"> 
                  <div class="AvatarWarningSmall"></div>
              </div>
          
              <div class="LeftBarNotificationMessageSection" > 
                  <div class="chatNotification webphone">
                      <div class="content">
                        <span>Web Phone</span></span> 
                        <div class="NotificationTime">{{   }}</div>
                      </div> 
                      <div ></div>
                      <div class="NotificationMessage">Phone registered on another device. Click on this message to set this instance as active.</div>
                  </div>
                  
              </div>
          </div>               
      </a> 
	
     </div> 
    </div>
  </div>
  <div class="CallStatusContainerOutbound" ng-repeat="currentCall in calls" ng-class="currentCall.incoming ? 'CallStatusContainerInbound' : 'CallStatusContainerOutbound'" ng-if="inCall" dockable="currentCall" droppable="Contact">                            
     <a href="#/showCallControlls?{{currentCall}}" class="CallStatusIconContainer">
         <div class="CallStatusIcon"> </div>
     </a>
     <a href="#/showCallControlls?{{currentCall}}" class="CallStatusText"> 
         <div class="memberName">{{currentCall.displayName}} <div class="MyCallBlock_Rec ng-class:{'true': currentCall.record}"></div></div>
         <div class="callStatus"><div>{{ currentCall.incoming ? verbage.inbound : verbage.outbound}} {{::verbage.on_call}}</div><span class="MyCallBlock_Duration">{{callObj[currentCall.xpid].minutesText}}{{callObj[currentCall.xpid].secondsText}}{{callObj[currentCall.xpid].hoursText}}</span></div>
     </a>              
     <div class="controlButtons">
         <a href="#/EndCall?{{currentCall.xpid}}" ng-if="currentCall.state == callState.CALL_RINGING" class="XButton">{{:: currentCall.incoming ? verbage.decline : verbage.cancel}}</a>
         <a href="#/EndCall?{{currentCall.xpid}}" class="XButton" ng-if="currentCall.state == callState.CALL_ACCEPTED">{{::verbage.end}}</a>
         <a href="#/HoldCall?{{currentCall.xpid,true}}" ng-class="currentCall.type == 0 ? 'disableButton' : ''" ng-disabled="currentCall.type == 0" ng-if="currentCall.state == callState.CALL_ACCEPTED" class="XButton">{{::verbage.hold}}</a>
         
         <a href="#/HoldCall?{{currentCall.xpid,false}}" class="XButton" ng-if="currentCall.state == callState.CALL_HOLD">{{::verbage.Talk}}</a>
         <a href="#/AcceptCall?{{currentCall.xpid}}" ng-if="currentCall.incoming && currentCall.state == callState.CALL_RINGING" class="XButton">{{::verbage.accept}}</a>
     </div>
                
  </div> 
  <!-- <div ng-repeat="currentCall in calls" ng-class="currentCall.incoming ? 'CallStatusContainerInbound' : 'CallStatusContainerOutbound'" ng-if="inCall"> 
        <div class="CallStatusIconContainer">
            <div class="CallStatusIcon"> </div>
        </div>
        <div style="display:inline-block" class="CallStatusText"> 
            <div style="font-weight:bold;font-size:11px" class="memberName">{{currentCall.displayName}} <div class="MyCallBlock_Rec ng-class:{'true': currentCall.record}"></div></div>
            <div class="callStatus"><div>{{ currentCall.incoming ? verbage.inbound : verbage.outbound}} {{::verbage.on_call}}</div><span class="MyCallBlock_Duration">{{callObj[currentCall.xpid].minutesText}}{{callObj[currentCall.xpid].secondsText}}{{callObj[currentCall.xpid].hoursText}}</span></div>
        </div>
        <div style="float:right;display:inline-block;margin-top:5px" class="controlButtons">
            <a href="#/CancelCall?{{currentCall.xpid}}"  ng-if="currentCall.state == callState.CALL_RINGING" class="XButton" value="{{::verbage.cancel}}" onclick="window.close()">{{:: currentCall.incoming ? verbage.decline : verbage.cancel}}</a>
            <a href="#/EndCall?{{currentCall.xpid}}" ng-if="currentCall.state == callState.CALL_ACCEPTED" class="XButton">{{::verbage.end}}</a>

            <a href="#/HoldCall?{{currentCall.xpid}}"  ng-if="currentCall.state == callState.CALL_ACCEPTED" class="XButton"  onclick="window.close()"  ng-class="currentCall.type == 0 ? 'disableButton' : ''" ng-disabled="currentCall.type == 0">{{::verbage.hold}}</a>
            
            <a href="#/ResumeCall?{{currentCall.xpid}}" ng-if="currentCall.state == callState.CALL_HOLD" class="XButton">{{::verbate.talk}}</a>
            <a href="#/AcceptCall?{{currentCall.xpid}}" ng-if="currentCall.incoming && currentCall.state == callState.CALL_RINGING"  class="XButton">{{::verbage.accept}}</a>
        </div>
    </div>

    <div style="margin:0px 0px 0px 0px;background-color: gray;color: white;padding: .25em;">
        <div style="width: 24px;height: 24px;background: url('img/XIconSet-24x24.png') no-repeat -48px -72px;display:inline-block"></div>
        <div style="display:inline-block;vertical-align: middle"><span>{{::verbage.notifications}}</span><span class="Event" ng-show="notifications.length > 0 " > {{ notifications.length + ' events' }} </span> </div>
        
        
        <a href="#/OpenNotifications"value="{{::verbage.Open}}" style="float:right;position: relative;display: inline-block;" class="XButton">{{::verbage.open}}</a>
    </div>

    <div class="NotificationMessages">
         <div class="Messages" ng-repeat="message in todaysNotifications | limitTo: messageLimit">
           <a href="#/contact?{{message.senderId}}" style="text-decoration:none">
            <div class="NotificationHeader ng-class:{'firstHeader': $index == 0};"> 
                <div class="NotificationHeaderBackground ng-class:{'firstHeaderTitle': $index == 0};"> 
                    <div class="NotificationClose" ng-click="remove_notification(message.xpid)"></div>
                </div>                  
            </div>
            </a>



                <div class="NotificationDivider ng-class:{'firstHeaderDivider': $index == 0};">
                    <img />
                </div>
                <div class="NotificationSection ng-class:{'firstsection': $index == 0, 'halfHeight': !showHeader};"> 
                    
                    <avatar 
                        class="LeftBarNotificationAvatarSection NotificationAvatar"
                        ng-click="go_to_notification_chat(message); storeRecent(message.senderId)" 
                        profile="message.fullProfile" 
                        type="{{message.type == 'chat' ? 11 : message.audience == 'queue' ? 3 : 4}}">
                    </avatar>
                
                    <div class="LeftBarNotificationMessageSection chatNotification" ng-init="message_section_notifications = getMessage(message)"> 

                        <a href="#/contact?{{message.senderId}}" style="text-decoration:none"> 
                        

                            <div ng-class="message.audience == 'queue' ? 'NotificationDisplayNameQueue' : 'NotificationDisplayName'" >
                                <span ng-if="message.displayName">{{ message.displayName}}</span>
                                <span ng-if="!message.displayName" style="width: 38.5%;">&nbsp;</span></span> 
                                <div class="NotificationTime">{{  convertTime(message.time) }} </div>
                            </div> 

                            <div class="NotificationType" ng-show="showNotificationBody">...{{ ::message.label }} 
                                <span class='NotificationDisplayName' ng-if="message.type == 'gchat'"> 
                            {{ message.audience == 'group' ? message.title : 'Room #' + message.conference.roomNumber + '(' + message.conference.extensionNumber + ')'}}
                                </span>
                            </div>

                            <div class="NotificationMessage"  ng-show="showNotificationBody" scroll-to-bottom>
                              <span ng-if="message.message && message.message.length > 1" ng-repeat="messageToDisplay in message_section_notifications track by $index">{{ messageToDisplay }}<br/></span>
                              <span ng-if="!message.message || message.message <= 1">{{ message_section_notifications }}</span>                               
                            </div> 
                        </a>
                        <div class="NotificationZoomBtn" ng-if="message.type == 'zoom'">
                            <a class="XButton XButtonRed" href="#/RejectZoom"> {{::verbage.Reject}}</span>
                            <a class="XButton XButtonGreen" href="#/AcceptZoom?{{message.data.url}}" >{{::verbage.accept}}</a>
                        
                        </div>
                        <div class="NotificationZoomBtn" ng-if="message.type == 'vm'">
                            <a class="XButton" style="width:70px" href="#/PlayVM?{{message.vmId}}" > {{::verbage.Play}}</a>
                            <a class="XButton XButtonGreen" style="width:90px" href="#/CallBack?{{message.phone}}">{{::verbage.call_back}}</a>
                        </div>

                        <div class="NotificationZoomBtn" ng-if="message.type == 'missed-call'">
                            <a class="XButton" style="width:70px" href="#contact/{{::contact.xpid}}">{{::verbage.chat}}</a>
                            <a class="XButton XButtonGreen" style="width:70px" href="#/CallBack?{{message.phone}}">{{::verbage.Call}}</a>
                        </div>
                    </div>
               </div>
            </div>
           </div> -->
 </div>      
</div>

