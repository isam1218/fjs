<div class="Overlay" ng-controller="CallStatusOverlayController">
	<div ng-click="showOverlay(false)" class="Background"></div>
	<div class="Foreground" ng-if="screen == 'call'">
		<div ng-click="showOverlay(false)" class="Close">x</div>
		
		<div class="Header">
			<h2>{{::verbage.call_management}}</h2>
		</div>
		
		<div class="Sections">
			<div class="Section">
				<div>
					<h4>{{::verbage.call_members}}</h4>
					<em>{{::verbage.contacts_talking}}</em>
				</div>
				<div class="Contact">
					<div class="Avatar AvatarNormal" context-menu="onCall">
						<img class="AvatarImgPH" data-ng-src="{{ onCall.getAvatar(28) }}" onerror="this.src='img/Generic-Avatar-28.png'" />
						<div class="AvatarForeground AvatarInteractable"></div>
					</div>
					<div class="Name">
						<strong>{{ onCall.displayName }}</strong>
						<br/>
						x{{ onCall.primaryExtension }}
					</div>
					
					<div class="Barging" ng-if="onCall.call.barge > 0">{{::verbage.barging}}</div>
					
					<div class="Time">{{ timeElapsed }}</div>
					
					<div class="Buttons">
						<input type="button" class="XButton" value="{{::verbage.barge}}" ng-click="bargeCall('barge', onCall.xpid)" ng-disabled="onCall.call.type != 4" />
						<input type="button" class="XButton" value="{{::verbage.monitor}}" ng-click="bargeCall('monitor', onCall.xpid)" ng-disabled="onCall.call.type != 4" />
						<input type="button" class="XButton" value="{{::verbage.whisper}}" ng-click="bargeCall('whisper', onCall.xpid)" ng-disabled="onCall.call.type != 4" />
						<input type="button" class="XButton" value="{{::verbage.transfer}}" ng-click="changeScreen('transfer', onCall.xpid)" ng-disabled="onCall.call.type != 4" />
					</div>
				</div>
				<div class="Contact">
					<div class="Avatar AvatarNormal" context-menu="onCall.call">
						<img class="AvatarImgPH" ng-src="{{ getCallStatusAvatar(onCall.call) }}" onerror="this.src='img/Generic-Avatar-28.png'" />
						<div class="AvatarForeground AvatarInteractable"></div>
					</div>
					<div class="Name">
						<strong>{{ onCall.call.displayName }}</strong>
						<br/>
						{{ onCall.call.phone }}
					</div>
					
					<div class="Time">{{ timeElapsed }}</div>
					
					<div class="Buttons">
						<input type="button" class="XButton" value="{{::verbage.barge}}" ng-click="bargeCall('barge', onCall.call.contactId)" ng-disabled="onCall.call.type != 4" />
						<input type="button" class="XButton" value="{{::verbage.monitor}}" ng-click="bargeCall('monitor', onCall.call.contactId)" ng-disabled="onCall.call.type != 4" />
						<input type="button" class="XButton" value="{{::verbage.whisper}}" ng-click="bargeCall('whisper', onCall.call.contactId)" ng-disabled="onCall.call.type != 4" />
						<input type="button" class="XButton" value="{{::verbage.transfer}}" ng-click="changeScreen('transfer', onCall.call.contactId)" ng-disabled="onCall.call.type != 4" />
					</div>
				</div>
			</div>
			
			<div class="Section">
				<div>
					<h4>{{::verbage.barged_by}}</h4>
					<em>{{::verbage.contacts_barge_call}}</em>
				</div>
				
				<div class="Bargers">
					<div ng-repeat="barger in onCall.call.bargers" class="ListRow ListRow">
						<div class="Avatar AvatarNormal" context-menu="barger">
							<img class="AvatarImgPH" data-ng-src="{{::barger.getAvatar(28)}}" onerror="this.src='img/Generic-Avatar-28.png'" />
							<div class="AvatarForeground AvatarInteractable"></div>
						</div>
			
						<div class="ListRowContent">
							<div class="ListRowTitle">
								<div class="name">
									<strong>{{ ::barger.displayName }}</strong>
									<span>#{{ ::barger.primaryExtension }}</span>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
		
		<div class="Footer">
			<div class="Error" ng-show="onCall.call.recorded">{{ recordingElapsed }}</div>
		
			<input type="button" class="XButton" value="{{ onCall.call.recorded ? 'Stop' : 'Start' }} Recording" ng-click="recordCall()" />
			<input type="button" class="XButton" value="Close" ng-click="showOverlay(false)" />
			<input type="button" class="XButton" value="Conferencing" ng-show="onCall.call.type == 4" ng-click="changeScreen('conference')" />
		</div>
	</div>
	
	<!-- transfer call -->
	<div class="Foreground" ng-show="screen == 'transfer'">
		<div ng-click="showOverlay(false)" class="Close">x</div>
		
		<div class="Header">
			<h2>{{::verbage.call_transfer}}</h2>
		</div>
		
		<div class="Sections">
			<div class="Section">
				<div>
					<h4>{{::verbage.contact_to_transfer}}</h4>
					<em>{{::verbage.transfer_selected_person}}</em>
				</div>
				<div class="Contact">
					<div class="Avatar AvatarNormal">
						<img class="AvatarImgPH" data-ng-src="{{ transferFrom.getAvatar ? transferFrom.getAvatar(28) : 'img/Generic-Avatar-28.png' }}" onerror="this.src='img/Generic-Avatar-28.png'" />
						<div class="AvatarForeground AvatarInteractable"></div>
					</div>
					<div class="Name">
						<strong>{{ transferFrom.displayName }}</strong>
						<br/>
						x{{ transferFrom.primaryExtension ? transferFrom.primaryExtension : transferFrom.phone }}
					</div>
					
					<div class="Time">{{ timeElapsed }}</div>
				</div>
			</div>
			
			<div class="Section" ng-show="!transferTo">
				<div>
					<h4>{{::verbage.destination}}</h4>
					<input type="search" class="Search" ng-model="tranQuery" placeholder="{{::verbage.search}}" />
				</div>
				<div class="Banner upper">{{::verbage.contacts}}</div>
				<div class="Members">
					<a href="" class="ListRow" ng-repeat="contact in contacts | filter: {displayName: tranQuery} track by contact.xpid" ng-click="selectDestination(contact)"> 
						<div class="Avatar AvatarNormal">
							<img class="AvatarImgPH" data-ng-src="{{::contact.getAvatar(28)}}" onerror="this.src='img/Generic-Avatar-28.png'" />
							<div class="AvatarForeground AvatarInteractable"></div>
						</div>
						<div class="ListRowContent">
							<div class="ListRowTitle">
								<strong>{{ ::contact.displayName }}</strong>
								<br/>
								<div class="ListRowStatusIcon XIcon-QueueStatus-{{contact.queue_status}}"></div>
								<div class="ListRowStatusIcon XIcon-ChatStatus-{{contact.hud_status || 'offline' }}"></div>
							</div>
						</div>
					</a>
				</div>
			</div>
			
			<div class="Section" ng-show="transferTo">
				<div>
					<h4>{{::verbage.office_destination}}</h4>
					<em>{{::verbage.call_transfer_destination}}</em>
				</div>
				<div>
					<a href="" class="ListRow"> 
						<div class="Avatar AvatarNormal">
							<img class="AvatarImgPH" data-ng-src="{{::transferTo.getAvatar(28)}}" onerror="this.src='img/Generic-Avatar-28.png'" />
							<div class="AvatarForeground AvatarInteractable"></div>
						</div>
						<div class="ListRowContent">
							<div class="ListRowTitle">
								<strong>{{ ::transferTo.displayName }}</strong>
								<br/>
								<div class="ListRowStatusIcon XIcon-QueueStatus-{{transferTo.queue_status}}"></div>
								<div class="ListRowStatusIcon XIcon-ChatStatus-{{transferTo.hud_status || 'offline' }}"></div>
							</div>
						</div>
					</a>
				</div>
				<div>
					<h4>{{::verbage.transfer_options}}</h4>
					<em>{{::verbage.call_transfer_destination}}</em>
				</div>
				<div>
					<input type="checkbox" ng-model="sendToPrimary" ng-value="{{sendToPrimary}}" ng-true-value="1" ng-false-value="0" /> {{::verbage.primary_extension}}
					<br/>
					<input type="checkbox" ng-model="sendToPrimary" ng-value="{{sendToPrimary}}" ng-true-value="0" ng-false-value="1" /> {{::verbage.voicemail_box}}x
				</div>
			</div>
		</div>
		
		<div class="Footer">
			<div class="Error" ng-show="addError" ng-bind="addError"></div>
			
			<input type="button" class="XButton" value="Cancel" ng-click="changeScreen('call')" />
			<input type="button" class="XButton" value="Transfer" ng-click="transferCall()" />
		</div>
	</div>
	
	<!-- conferencing -->
	<div class="Foreground" ng-show="screen == 'conference'">
		<div ng-click="showOverlay(false)" class="Close">x</div>
		
		<div class="Header">
			<h2>{{::verbage.transfer_to_conference_room}}</h2>
		</div>
		
		<div class="Sections">
			<div class="Section">
				<div>
					<h4>{{::verbage.contact_to_transfer}}</h4>
					<em>{{::verbage.contacts_will_be_transfered_to_conference}}</em>
				</div>
				<div>
					<div class="ListRow">
						<div class="Avatar AvatarNormal">
							<img class="AvatarImgPH" data-ng-src="{{::onCall.getAvatar(28)}}" onerror="this.src='img/Generic-Avatar-28.png'" />
							<div class="AvatarForeground AvatarInteractable"></div>
						</div>
						<div class="ListRowContent">
							<div class="ListRowTitle">
								<div class="name">
									<strong>{{ ::onCall.displayName }}</strong>
									<span>{{ ::onCall.primaryExtension }}</span>
								</div>
							</div>
						</div>
					</div>
					<div class="ListRow">
						<div class="Avatar AvatarNormal">
							<img class="AvatarImgPH" data-ng-src="{{::getCallStatusAvatar(onCall.call)}}" onerror="this.src='img/Generic-Avatar-28.png'" />
							<div class="AvatarForeground AvatarInteractable"></div>
						</div>
						<div class="ListRowContent">
							<div class="ListRowTitle">
								<div class="name">
									<strong>{{ ::onCall.call.displayName }}</strong>
									<span>{{ ::onCall.call.phone }}</span>
								</div>
							</div>
						</div>
					</div>
				</div>
				
				<div>
					<h4>{{::verbage.Options}}</h4>
					<em>{{::verbage.add_yourself_to_conference}}</em>
				</div>
				
				<input type="checkbox" ng-model="meToo" ng-true-value="1" ng-false-value="0" /> {{::verbage.join_me_as_well}}
			</div>
			
			<div class="Section" ng-show="!selectedConf">
				<div>
					<h4>{{::verbage.conference_room}}</h4>
					<input type="search" class="Search" ng-model="confQuery" placeholder="{{::verbage.search_by_room_or_person}}" />
				</div>
				<div class="Members">
                    <a href="" class="ListRow ListRow-Conference" data-ng-repeat="conference in conferences | filter: customConfFilter() track by conference.xpid" ng-click="selectConference(conference)">
                        <div class="ConferenceAvatarSection Avatar AvatarNormal">
                            <div class="GroupAvatarItem GroupAvatarItem_0" context-menu="conference">
								<img class="GroupAvatarItemImg" ng-src="{{ conference.getAvatar(0, 14) }}" onerror="this.src='img/Generic-Avatar-14.png'" />
							</div>
                            <div class="GroupAvatarItem GroupAvatarItem_1">
								<img class="GroupAvatarItemImg" ng-src="{{ conference.getAvatar(1, 14) }}" onerror="this.src='img/Generic-Avatar-14.png'" />
							</div>
                            <div class="GroupAvatarItem GroupAvatarItem_2">
								<img class="GroupAvatarItemImg" ng-src="{{ conference.getAvatar(2, 14) }}" onerror="this.src='img/Generic-Avatar-14.png'" />
							</div>
							<div class="GroupAvatarItem GroupAvatarItem_3">
								<img class="GroupAvatarItemImg" ng-src="{{ conference.getAvatar(3, 14) }}" onerror="this.src='img/Generic-Avatar-14.png'" />
							</div>
							
                            <div class="AvatarInteractable"></div>
                        </div>
                        <div class="ListRowContent">
                            <div class="ListRowTitle">
                                <div class="name"> {{::verbage.room}} # {{::conference.roomNumber}} ({{::conference.extensionNumber}})</div>
								 
                                <div data-ng-if="conference.members.length == 0">
                                    <div class="ListConferenceStatusIcon XIcon-ChatStatus-Offline"></div>
									{{::verbage.free_room}}
                                </div>                            
                                <div data-ng-if="conference.members.length > 0">
                                    <div class="ListRowStatusIcon XIcon-ChatStatus-Available"></div>
									{{conference.members.length}} {{::verbage.members_on_call}}
								</div> 
                            </div>
                        </div>
                    </a>
				</div>
			</div>
			
			<div class="Section" ng-show="selectedConf">
				<div>
					<h4>{{::verbage.destination}}</h4>
				</div>
				
				<div>
					<a href="" class="ListRow ListRow-Conference">
						<div class="ConferenceAvatarSection Avatar AvatarNormal">
							<div class="GroupAvatarItem GroupAvatarItem_0">
								<img class="GroupAvatarItemImg" ng-src="{{ selectedConf.getAvatar(0, 14) }}" onerror="this.src='img/Generic-Avatar-14.png'" />
							</div>
							<div class="GroupAvatarItem GroupAvatarItem_1">
								<img class="GroupAvatarItemImg" ng-src="{{ selectedConf.getAvatar(1, 14) }}" onerror="this.src='img/Generic-Avatar-14.png'" />
							</div>
							<div class="GroupAvatarItem GroupAvatarItem_2">
								<img class="GroupAvatarItemImg" ng-src="{{ selectedConf.getAvatar(2, 14) }}" onerror="this.src='img/Generic-Avatar-14.png'" />
							</div>
							<div class="GroupAvatarItem GroupAvatarItem_3">
								<img class="GroupAvatarItemImg" ng-src="{{ selectedConf.getAvatar(3, 14) }}" onerror="this.src='img/Generic-Avatar-14.png'" />
							</div>
							
							<div class="AvatarInteractable"></div>
						</div>
						<div class="ListRowContent">
							<div class="ListRowTitle">
								<div class="name"> {{::verbage.room}} # {{::selectedConf.roomNumber}} ({{::selectedConf.extensionNumber}})</div>
								
								<div data-ng-if="selectedConf.members.length == 0">
									<div class="ListConferenceStatusIcon XIcon-ChatStatus-Offline"></div>
									{{::verbage.free_room}}
								</div>                            
								<div data-ng-if="selectedConf.members.length > 0">
									<div class="ListRowStatusIcon XIcon-ChatStatus-Available"></div>
									{{selectedConf.members.length}} {{::verbage.members_on_call}}
								</div> 
							</div>
							
							<div class="ListRowStatus" ng-if="selectedConf.location">
								at {{::selectedConf.location}}
							</div>
						</div>
					</a>
				</div>
				
				<div>
					<h4>{{::verbage.are_you_ready}}?</h4>
					<em>{{::verbage.call_transfer_to_conference}}</em>
				</div>
			</div>
		</div>
		
		<div class="Footer">
			<div class="Error" ng-show="addError" ng-bind="addError"></div>
			
			<input type="button" class="XButton" value="{{::verbage.cancel}}" ng-click="changeScreen('call')" />
			<input type="button" class="XButton" value="{{::verbage.join}}" ng-click="joinConference()" />
		</div>
	</div>
</div>